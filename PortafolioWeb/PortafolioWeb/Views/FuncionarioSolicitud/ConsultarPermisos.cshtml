@model PortafolioWeb.FUNCIONARIO
@{
    ViewBag.Title = "ConsultarPermisos";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@using Newtonsoft.Json
@Styles.Render("https://cdn.datatables.net/1.10.16/css/dataTables.bootstrap.min.css")
@Scripts.Render("https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js")
@Scripts.Render("https://cdn.datatables.net/1.10.16/js/dataTables.bootstrap.min.js")
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container-fluid">
        <div class="navbar-header">
            <a class="navbar-brand" href="#">I.Municipalidad Vista Hermosa</a>
        </div>
        <ul class="nav navbar-nav">
            <li class="active">@Html.ActionLink("Inicio", "Index", "FuncionarioSolicitud")</li>
            <li class="active">@Html.ActionLink("Solicitar Permiso", "FuncionarioSolicitud", "FuncionarioSolicitud")</li>
            <li class="active">@Html.ActionLink("Consultar Permisos", "ConsultarPermisos", "FuncionarioSolicitud")</li>
        </ul>
        <ul class="nav navbar-nav navbar-right">
            <li>@Html.ActionLink("Cerrar Sesión", "EndSession", "Login")</li>
        </ul>
    </div>
</nav>
<br/>
<div class="container">

    <form class="well form-horizontal">
        <fieldset>

            <!-- Form Name -->
            <legend>Consulta de Permiso</legend>

            <div class="table-responsive">
                <table class="table" id="table_">
                    <thead>
                        <tr>
                            <th>Identificador</th>
                            <th>Fecha de inicio</th>
                            <th>Fecha de término</th>
                            <th>Estado</th>
                            <th>Fecha de emisión</th>
                            <th>Descripción</th>
                        </tr>
                    </thead>
                </table>
                </div>
        </fieldset>
    </form>
</div>
@section Scripts{
<script>
    $(document).ready(function () {
        var rut = '@Session["rut"].ToString()';
        var table = $("#table_").DataTable({
            language: {
                url: "https://cdn.datatables.net/plug-ins/1.10.16/i18n/Spanish.json"
            },
            destroy: true,
            responsive: true,
            ajax:{
                url: "/FuncionarioSolicitud/GetPermisosPorRut",
                type: "GET",
                dataType: "JSON",
                data: {
                    rut: rut,
                    function (data) {
                        console.log(data);
                        return JSON.stringify(data);
                    }
                },
                dataSrc: "",
                error: function () {
                    alert("Algo salió mal.")
                },
            },
            columns: [
                { "data": "ID_SOLICITUD" },
                { "data": "FECHA_INICIO" },
                { "data": "FECHA_FIN" },
                { "data": "ID_ESTADO" },
                { "data": "FECHA_CREACION" },
                { "data": "DESCRIPCION" },
            ]
    })
    })
</script>   
}

